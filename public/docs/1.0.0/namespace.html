<article>
  <div class="version-display" data-bind="text: versionDisplay"></div>
  <a id="introduction" class="section-anchor" data-bind="sectionAnchor"></a>
  <section data-name="introduction">
    <div class="highlight"></div>
    <header>
      <h1 class="title">Introduction</h1>
    </header>
    <div class="content">
      <p>A <span class="inline-code">namespace</span> in FootworkJS can be thought of as a communication 'channel'. They are the information highways
        your application uses to shuffle data and state from one area to another.</p>

      <p>Organizing your code and keeping it <a href="https://en.wikipedia.org/wiki/Loose_coupling" target="_blank">loosely coupled</a> is
        extremely important in more complex javascript applications. Without a standardized way of coordinating and sharing information, an application
        will quickly turn into to a horrible tangled mess.</p>

      <p>FootworkJS enables you to organize your code into (and allowing comminication + sharing of state between)
        <span class="inline-code">namespace</span> channels. Namespaces boil down to a simple <span class="inline-code">'string'</span> identifier which is
        used to segment off the communication meant for one area from another.</p>

      <p>Additionally of note Footwork <span class="inline-code"><a data-bind="$route: docLink('viewModel')">viewModels</a></span>,
        <span class="inline-code"><a data-bind="$route: docLink('dataModel')">dataModels</a></span>,
        <span class="inline-code"><a data-bind="$route: docLink('router')">routers</a></span>, and
        <span class="inline-code"><a data-bind="$route: docLink('collection')">collections</a></span> all have <span class="inline-code">namespace</span>
        channels integrated into them to enable many of their features.</p>

      <div class="note"><span class="label">NOTE:</span> At its core namespaces in FootworkJS are enhanced
        <a href="https://github.com/postaljs/postal.js" target="_blank">postal.js</a> pub/sub channels. If you need to enhance or alter how communication is handled then you likely
        want to take a look at the postal documentation.</div>
    </div>
  </section>

  <a id="usage" class="section-anchor" data-bind="sectionAnchor"></a>
  <section data-name="usage">
    <div class="highlight"></div>
    <header>
      <h1 class="sub title">Usage</h1>
    </header>
    <div class="content">
      <p>There are essentially 2 different ways a <span class="inline-code">namespace</span> can be instantiated and used:</p>

      <ul>
        <li>Integrated with (Managed by) a <span class="inline-code"><a data-bind="$route: docLink('viewModel')">viewModel</a></span> /
          <span class="inline-code"><a data-bind="$route: docLink('dataModel')">dataModel</a></span> /
          <span class="inline-code"><a data-bind="$route: docLink('router')">router</a></span> and automatically disposed of for you.</li>
        <li>Independently instantiated and disposed of by you.</li>
      </ul>

      <div class="note"><span class="label">NOTE:</span> If you need to share data/state across different areas/modules of your application
        then you may want to also take a look at FootworkJS
        <span class="inline-code"><a data-bind="$route: docLink('broadcastable-receivable')">broadcastables / receivables</a></span>. They utilize
        <span class="inline-code">namespaces</span> to easily synchronize data/state across your application.</div>
    </div>
  </section>

  <a id="managed-usage" class="section-anchor" data-bind="sectionAnchor"></a>
  <section data-name="integrated-usage">
    <div class="highlight"></div>
    <header>
      <h2 class="sub title">Managed Usage</h2>
    </header>
    <div class="content">
      <p>All <span class="inline-code"><a data-bind="$route: docLink('viewModel')">viewModels</a></span> /
        <span class="inline-code"><a data-bind="$route: docLink('dataModel')">dataModels</a></span> /
        <span class="inline-code"><a data-bind="$route: docLink('router')">routers</a></span> that are instantiated manage their own
        <span class="inline-code">namespace</span> channels. This includes the <span class="inline-code">namespace</span> channels automatically
        instantiated for you (ex: <span class="inline-code"><a data-bind="$route: docLink('viewModel#viewModel-namespace')">viewModel.$namespace</a></span>
        and <span class="inline-code"><a data-bind="$route: docLink('viewModel#viewModel-rootNamespace')">viewModel.$rootNamespace</a></span>)
        as well as other ones you might instantiate onto the parent object yourself.</p>

      <p>Any subscriptions/handlers/etc created on a managed <span class="inline-code">namespace</span> will be cleaned up when the parent
        <span class="inline-code"><a data-bind="$route: docLink('viewModel')">viewModel</a></span> /
        <span class="inline-code"><a data-bind="$route: docLink('dataModel')">dataModel</a></span> /
        <span class="inline-code"><a data-bind="$route: docLink('router')">router</a></span>
        it is attached to is disposed of.</p>

      <p>The following shows an example of use of a managed <span class="inline-code">namespace</span> on a
      <span class="inline-code">viewModel</span>.</p>

<div class="file-location">index.html</div>
<pre><code>&lt;html&gt;
  &lt;body&gt;
    &lt;!--
      namespace and all attached handlers for Sprocket viewModel
      handled automatically whenever it is added or removed from the DOM
    --&gt;
    &lt;viewModel module="Sprocket"&gt;
      &lt;!-- ko if: isExpensive --&gt;Warning: Expensive sprocket.&lt;!-- /ko --&gt;
    &lt;/viewModel&gt;
    &lt;script src="main.js"&gt;&lt;/script&gt;
  &lt;/body&gt;
&lt;/html&gt;</code></pre>

<div class="file-location">main.js</div>
<pre><code class="javascript">fw.viewModel.create({
  namespace: 'Sprocket',
  autoRegister: true,
  initialize: function() {
    // this.$namespace.getName() === 'Sprocket'
    this.isExpensive = fw.observable(false);
    this.$namespace.subscribe('ThrowAway', function(reason) {
      // this handler will be automatically unsubscribed and cleaned up when its parent viewModel is disposed
    });

    // Create another managed namespace channel for 'someOtherNamespace'
    this.$someOtherNamespace = fw.namespace('someOtherNamespace');
    this.$someOtherNamespace.subscribe('ThrowAway', function(reason) {
      // this handler will be automatically unsubscribed and cleaned up when its parent viewModel is disposed
    });
  }
});

fw.applyBindings();
</code></pre>

      <p>There are various ways for a <span class="inline-code"><a data-bind="$route: docLink('viewModel')">viewModel</a></span> /
        <span class="inline-code"><a data-bind="$route: docLink('dataModel')">dataModel</a></span> /
        <span class="inline-code"><a data-bind="$route: docLink('router')">router</a></span> to be disposed of, depending on your particular context
        you should seek the relevant lifecycle information pertaining to the type of parent your managed <span class="inline-code">namespace</span> is
        attached to:</p>

      <ul>
        <li><a data-bind="$route: docLink('viewModel#lifecycle')">viewModel Lifecycle</a></li>
        <li><a data-bind="$route: docLink('dataModel#lifecycle')">dataModel Lifecycle</a></li>
        <li><a data-bind="$route: docLink('router#lifecycle')">router Lifecycle</a></li>
      </ul>
    </div>
  </section>

  <a id="independent-usage" class="section-anchor" data-bind="sectionAnchor"></a>
  <section data-name="independent-usage">
    <div class="highlight"></div>
    <header>
      <h2 class="sub title">Independent Usage</h2>
    </header>
    <div class="content">
      <p>Sometimes you might want to create a <span class="inline-code">namespace</span> channel outside of the context of a
        <span class="inline-code"><a data-bind="$route: docLink('viewModel')">viewModel</a></span> /
        <span class="inline-code"><a data-bind="$route: docLink('dataModel')">dataModel</a></span> /
        <span class="inline-code"><a data-bind="$route: docLink('router')">router</a></span>. An example of this might be if you wanted to publish an
        event to a different part of your application from a jQuery plugin.</p>

      <p>To do this you will need to instantiate a <span class="inline-code">namespace</span> channel. This is done by calling the factory method
        <span class="inline-code">fw.namespace()</span>.</p>

      <a id="fw-namespace" class="section-anchor" data-bind="sectionAnchor"></a>
      <div class="ref-block">
        <div class="title">
          <div class="type"><span class="icon icon-code"></span></div>
          <div class="func-def"><span>fw</span>.namespace<span>( <span class="param">'namespaceName'</span> )</span></div>
        </div>
        <div class="description">Create a <span class="inline-code">namespace</span> channel/instance.</div>
        <div class="return-value">
          <span class="label">Returns:</span>
          <span class="value"><span class="type">object{}</span> The <span class="inline-code">namespace</span> instance</span>
        </div>
      </div>
<pre><code class="javascript">var myNamespace = fw.namespace('myNamespace');
myNamespace.subscribe('sayHello', function(toWhom) {
  console.info('Greetings ' + toWhom);
});

myNamespace.publish('sayHello', 'Jonathan'); // console prints: 'Greetings Jonathan'
</code></pre>

      <p>It is important to note that namespaces are based on their <span class="inline-code">'string'</span> key, not the instantiated object...they are just the channels
        <em>to</em> that namespace.</p>

      <h3>This means that each newly instantiated namespace with the same <span class="inline-code">'string'</span> key will all hear the same events/commands/etc:</h3>
<pre><code class="javascript">var myNamespace = fw.namespace('myNamespace');
myNamespace.subscribe('sayHello', function(toWhom) {
  console.log('Greetings ' + toWhom);
});

var alsoMyNamespace = fw.namespace('myNamespace');
alsoMyNamespace.publish('hello', 'Jonathan'); // console prints: 'Greetings Jonathan'
</code></pre>
    </div>
  </section>

  <a id="lifecycle" class="section-anchor" data-bind="sectionAnchor"></a>
  <section data-name="lifecycle">
    <div class="highlight"></div>
    <header>
      <h2 class="sub title">Lifecycle</h2>
    </header>
    <div class="content">
      <p>Managed <span class="inline-code">namespace</span> subscriptions and handlers are automatically cleaned up for you when the parent object
        lifecycle ends. Independently used <span class="inline-code">namespace</span> channels will need to be disposed of.<p>

      <a id="namespace-dispose" class="section-anchor" data-bind="sectionAnchor"></a>
      <div class="ref-block">
        <div class="title">
          <div class="type"><span class="icon icon-code"></span></div>
          <div class="func-def"><span>namespace</span>.dispose<span>()</span></div>
        </div>
        <div class="description">Dispose of all registered subscriptions and handlers.</div>
      </div>
<pre><code class="javascript">var myNamespace = fw.namespace('Waldo');
myNamespace.request.handler('ping', function() {
  return 'pong';
});
// myNamespace.request('ping') === 'pong'

myNamespace.dispose();
// myNamespace.request('ping') === undefined</code></pre>
    </div>
  </section>

  <a id="namespace-getName" class="section-anchor top"></a>
  <section data-name="namespace-getName" class="top">
    <div class="highlight"></div>
    <div class="content">
      <h3 class="top"><em class="func-def">namespace.getName<span>( )</span></em></h3>
      <h3>Get the name (channel) of the namespace:</h3>
<pre><code class="javascript">var myNamespace = fw.namespace('Waldo');
// myNamespace.getName() === 'Waldo'</code></pre>
    </div>
  </section>

  <a id="pub-sub" class="section-anchor" data-bind="sectionAnchor"></a>
  <section data-name="pub-sub">
    <div class="highlight"></div>
    <header>
      <h2 class="sub title">Publish / Subscribe</h2>
    </header>
    <div class="content">
      <p>Publish and subscribe to messages on a namespace channel.</p>
    </div>
  </section>

  <a id="publish" class="section-anchor top"></a>
  <section data-name="publish" class="top">
    <div class="highlight"></div>
    <div class="content">
      <h3 class="top"><em class="func-def">namespace.publish<span>( <span class="param">'topic'</span>,  <span class="param">data</span> )</span></em></h3>
      <h3>Publish a message on a namespace topic:</h3>
<pre><code class="javascript">// sends data to any listeners subscribed to the topic 'sayHello' on the myNamespace channel
myNamespace.publish('sayHello', 'Jonathan');</code></pre>
    </div>
  </section>

  <a id="subscribe" class="section-anchor top"></a>
  <section data-name="subscribe" class="top">
    <div class="highlight"></div>
    <div class="content">
      <h3 class="top"><em class="func-def">namespace.subscribe<span>( <span class="param">'topic'</span>,  <span class="param">function(message) { ... }</span> )</span></em></h3>
      <h3>Subscribe to a topic on a namespace:</h3>
<pre><code class="javascript">myNamespace.subscribe('sayHello', function(toWhom) {
  console.log('Greetings ' + toWhom);
});</code></pre>
    </div>
  </section>

  <a id="unsubscribe" class="section-anchor top"></a>
  <section data-name="unsubscribe" class="top">
    <div class="highlight"></div>
    <div class="content">
      <h3 class="top"><em class="func-def">namespace.unsubscribe<span>( <span class="param">subscription</span> )</span></em></h3>
      <h3>Unsubscribe to a topic on a namespace:</h3>
<pre><code class="javascript">var greetingSubscription = myNamespace.subscribe('sayHello', function(toWhom) {
  console.log('Greetings ' + toWhom);
});

myNamespace.unsubscribe(greetingSubscription);
greetingSubscription.unsubscribe(); // also works</code></pre>
    </div>
  </section>

  <a id="event" class="section-anchor" data-bind="sectionAnchor"></a>
  <section data-name="event">
    <div class="highlight"></div>
    <header>
      <h2 class="sub title">Event</h2>
    </header>
    <div class="content">
      <p>Trigger and handle events on a namespace.</p>
    </div>
  </section>

  <a id="trigger-event" class="section-anchor top"></a>
  <section data-name="trigger-event" class="top">
    <div class="highlight"></div>
    <div class="content">
      <h3 class="top"><em class="func-def">namespace.trigger<span>( <span class="param">'eventName'</span>,  <span class="param">data</span> )</span></em></h3>
      <h3>Trigger an event on a namespace:</h3>
<pre><code class="javascript">// sends data to any listeners bound to the topic 'sayHello' on the myNamespace channel
myNamespace.trigger('buyGroceries', { milk: 1, eggs: 12 });

// You can also trigger bare events
myNamespace.trigger('findWaldo');</code></pre>
    </div>
  </section>

  <a id="event-handler" class="section-anchor top"></a>
  <section data-name="event-handler" class="top">
    <div class="highlight"></div>
    <div class="content">
      <h3 class="top"><em class="func-def">namespace.event.handler<span>( <span class="param">'eventName'</span>,  <span class="param">function(data) { ... }</span> )</span></em></h3>
      <h3>Create a handler for an event on a namespace:</h3>
<pre><code class="javascript">myNamespace.event.handler('foundWaldo', function(location) {
  console.log('Found Waldo at', location);
});

myNamespace.event.handler('findWaldo', function() {
  // go find Waldo
});</code></pre>
    </div>
  </section>

  <a id="event-unregister" class="section-anchor top"></a>
  <section data-name="event-unregister" class="top">
    <div class="highlight"></div>
    <div class="content">
      <h3 class="top"><em class="func-def">namespace.event.unregister<span>( <span class="param">handler</span> )</span></em></h3>
      <h3>Unregister an event handler:</h3>
<pre><code class="javascript">var foundWaldo = myNamespace.event.handler('foundWaldo', function() {
  // yay, we found Waldo
});

myNamespace.event.unregister(foundWaldo);
foundWaldo.unsubscribe(); // also works</code></pre>
    </div>
  </section>

  <a id="request" class="section-anchor" data-bind="sectionAnchor"></a>
  <section data-name="request">
    <div class="highlight"></div>
    <header>
      <h2 class="sub title">Request</h2>
    </header>
    <div class="content">
      <p>Request and respond to data requests on a namespace.</p>
    </div>
  </section>

  <a id="issue-request" class="section-anchor top"></a>
  <section data-name="issue-request" class="top">
    <div class="highlight"></div>
    <div class="content">
      <h3 class="top"><em class="func-def">namespace.request<span>( <span class="param">'requestKey'</span>,  <span class="param">data</span>, <span class="param">allowMultiple = false</span> )</span></em></h3>
      <h3>Request data from a namespace:</h3>
<pre><code class="javascript">myNamespace.request.handler('waldoLocation', function() {
  return 'I have no idea.';
});
// myNamespace.request('waldoLocation') === 'I have no idea.'

/**
 * By passing 'true' as the third argument to .request(), Footwork will
 * return an array of responses received. By default only the first is returned
 * otherwise.
 */
myNamespace.request.handler('something', function() {
  return 'response 1';
});
myNamespace.request.handler('something', function() {
  return 'response 2';
});
// myNamespace.request('waldoLocation', null, true) === [ 'response 1', 'response 2' ]</code></pre>
    </div>
  </section>

  <a id="request-handler" class="section-anchor top"></a>
  <section data-name="request-handler" class="top">
    <div class="highlight"></div>
    <div class="content">
      <h3 class="top"><em class="func-def">namespace.request.handler<span>( <span class="param">'requestKey'</span>,  <span class="param">function(data) { ... }</span> )</span></em></h3>
      <h3>Create a handler for an request on a namespace, return value is passed back to the requester:</h3>
<pre><code class="javascript">myNamespace.request.handler('waldoLocation', function() {
  return 'I have no idea.';
});

// Take a parameter, do something with it and return a response
myNamespace.request.handler('taxCost', function(amount) {
  return amount * 0.0825;
});</code></pre>
    </div>
  </section>

  <a id="request-unregister" class="section-anchor top"></a>
  <section data-name="request-unregister" class="top">
    <div class="highlight"></div>
    <div class="content">
      <h3 class="top"><em class="func-def">namespace.request.unregister<span>( <span class="param">handler</span> )</span></em></h3>
      <h3>Unregister an request handler:</h3>
<pre><code class="javascript">var waldoLocationResponder = myNamespace.request.handler('waldoLocation', function() {
  return 'I have no idea.';
});
// myNamespace.request('waldoLocation') === 'I have no idea'

myNamespace.request.unregister(waldoLocationResponder);
waldoLocationResponder.unsubscribe(); // also works

// myNamespace.request('waldoLocation') === undefined
</code></pre>
    </div>
  </section>

  <a id="command" class="section-anchor" data-bind="sectionAnchor"></a>
  <section data-name="command">
    <div class="highlight"></div>
    <header>
      <h2 class="sub title">Command</h2>
    </header>
    <div class="content">
      <p>Issue and perform operations based on commands sent to a namespace.</p>
    </div>
  </section>

  <a id="issue-command" class="section-anchor top"></a>
  <section data-name="issue-command" class="top">
    <div class="highlight"></div>
    <div class="content">
      <h3 class="top"><em class="func-def">namespace.command<span>( <span class="param">'commandName'</span>,  <span class="param">data</span> )</span></em></h3>
      <h3>Issue a command to a namespace:</h3>
<pre><code class="javascript">myNamespace.command('findWaldo');</code></pre>
    </div>
  </section>

  <a id="command-handler" class="section-anchor top"></a>
  <section data-name="command-handler" class="top">
    <div class="highlight"></div>
    <div class="content">
      <h3 class="top"><em class="func-def">namespace.command.handler<span>( <span class="param">'commandName'</span>,  <span class="param">function(data) { ... }</span> )</span></em></h3>
      <h3>Create a handler for a command on a namespace:</h3>
<pre><code class="javascript">myNamespace.command.handler('buyGroceries', function(items) {
  // buy groceries
});

myNamespace.command.handler('findWaldo', function() {
  // go find Waldo
});</code></pre>
    </div>
  </section>

  <a id="command-unregister" class="section-anchor top"></a>
  <section data-name="command-unregister" class="top">
    <div class="highlight"></div>
    <div class="content">
      <h3 class="top"><em class="func-def">namespace.command.unregister<span>( <span class="param">handler</span> )</span></em></h3>
      <h3>Unregister a command handler:</h3>
<pre><code class="javascript">var findWaldo = myNamespace.command.handler('findWaldo', function() {
  // go find Waldo
});

myNamespace.command.unregister(findWaldo);
findWaldo.unsubscribe(); // also works</code></pre>
    </div>
  </section>

</article>

<div id="metaData">
{
  "title": "Namespace",
  "description": "Communicate to/from, send/receive commands, and trigger events between differing areas of your application.",
  "sections": [
    { "anchor": "introduction",
      "title": "Introduction",
      "subSections": [
        { "anchor": "usage",
          "title": "Usage",
          "subSections": [
            { "anchor": "managed-usage",
              "title": "Managed Usage" },
            { "anchor": "independent-usage",
              "title": "Independent Usage" },
            { "anchor": "lifecycle",
              "title": "Lifecycle" }
          ] }
      ] },
    { "anchor": "pub-sub",
      "title": "Pub / Sub",
      "collapsable": true,
      "isCollapsed": true,
      "subSections": [
        { "anchor": "publish",
          "title": "namespace.publish()" },
        { "anchor": "subscribe",
          "title": "namespace.subscribe()" },
        { "anchor": "unsubscribe",
          "title": "namespace.unsubscribe()" }
      ] },
    { "anchor": "event",
      "title": "Event",
      "collapsable": true,
      "isCollapsed": true,
      "subSections": [
        { "anchor": "trigger-event",
          "title": "namespace.trigger()" },
        { "anchor": "event-handler",
          "title": "namespace.event.handler()" },
        { "anchor": "event-unregister",
          "title": "namespace.event.unregister()" }
      ] },
    { "anchor": "request",
      "title": "Request",
      "collapsable": true,
      "isCollapsed": true,
      "subSections": [
        { "anchor": "issue-request",
          "title": "namespace.request()" },
        { "anchor": "request-handler",
          "title": "namespace.request.handler()" },
        { "anchor": "request-unregister",
          "title": "namespace.request.unregister()" }
      ] },
    { "anchor": "command",
      "title": "Command",
      "collapsable": true,
      "isCollapsed": true,
      "subSections": [
        { "anchor": "issue-command",
          "title": "namespace.command()" },
        { "anchor": "command-handler",
          "title": "namespace.command.handler()" },
        { "anchor": "command-unregister",
          "title": "namespace.command.unregister()" }
      ] }
  ],
  "apiReferences": [
    {
      "label": "",
      "subCategories": [
        {
          "label": "General",
          "references": [
            { "anchor": "fw-namespace",
              "title": "fw.namespace()",
              "description": "Create a namespace channel/instance." }
          ]
        }
      ]
    },
    {
      "label": "",
      "subCategories": [
        {
          "label": "Lifecycle",
          "references": [
            { "anchor": "namespace-dispose",
              "title": "namespace.dispose()",
              "description": "Dispose of all registered subscriptions and handlers." }
          ]
        }
      ]
    }
  ]
}
</div>
